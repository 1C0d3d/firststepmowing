<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Infinite Game</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #000;
    height: 100%;
    width: 100%;
    touch-action: none;
  }
  canvas {
    display: block;
    width: 100vw;
    height: 100vh;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

let player = { x: canvas.width / 2, y: canvas.height - 50, size: 20, color: "#0ff" };
let bullets = [];
let enemies = [];
let score = 0;
let highScore = localStorage.getItem("highScore") || 0;
let lastSpawn = 0;

function spawnEnemy() {
  let size = 20 + Math.random() * 30;
  enemies.push({
    x: Math.random() * (canvas.width - size),
    y: -size,
    size: size,
    speed: 2 + Math.random() * 3,
    color: "hsl(" + Math.random() * 360 + ", 80%, 60%)"
  });
}

function drawPlayer() {
  ctx.fillStyle = player.color;
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.size, 0, Math.PI * 2);
  ctx.fill();
}

function drawEnemies() {
  enemies.forEach(e => {
    ctx.fillStyle = e.color;
    ctx.beginPath();
    ctx.arc(e.x, e.y, e.size, 0, Math.PI * 2);
    ctx.fill();
  });
}

function drawBullets() {
  ctx.fillStyle = "#fff";
  bullets.forEach(b => {
    ctx.beginPath();
    ctx.arc(b.x, b.y, 5, 0, Math.PI * 2);
    ctx.fill();
  });
}

function update() {
  bullets.forEach((b, i) => {
    b.y -= 8;
    if (b.y < 0) bullets.splice(i, 1);
  });
  enemies.forEach((e, i) => {
    e.y += e.speed;
    if (e.y > canvas.height) enemies.splice(i, 1);
  });
  bullets.forEach((b, bi) => {
    enemies.forEach((e, ei) => {
      let dx = b.x - e.x;
      let dy = b.y - e.y;
      let dist = Math.sqrt(dx * dx + dy * dy);
      if (dist < e.size) {
        enemies.splice(ei, 1);
        bullets.splice(bi, 1);
        score++;
        if (score > highScore) {
          highScore = score;
          localStorage.setItem("highScore", highScore);
        }
      }
    });
  });
}

function drawScore() {
  ctx.fillStyle = "#fff";
  ctx.font = "20px Arial";
  ctx.fillText("Score: " + score, 10, 30);
  ctx.fillText("High Score: " + highScore, 10, 60);
}

function loop(timestamp) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (timestamp - lastSpawn > 1000) {
    spawnEnemy();
    lastSpawn = timestamp;
  }
  drawPlayer();
  drawEnemies();
  drawBullets();
  drawScore();
  update();
  requestAnimationFrame(loop);
}

canvas.addEventListener("touchstart", e => {
  let touch = e.touches[0];
  player.x = touch.clientX;
  player.y = touch.clientY;
  bullets.push({ x: player.x, y: player.y });
});
canvas.addEventListener("touchmove", e => {
  let touch = e.touches[0];
  player.x = touch.clientX;
  player.y = touch.clientY;
});

requestAnimationFrame(loop);
</script>
</body>
</html>